"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_src_lib_firestore-data-fetcher_ts";
exports.ids = ["_rsc_src_lib_firestore-data-fetcher_ts"];
exports.modules = {

/***/ "(rsc)/./src/lib/firebase-admin.ts":
/*!***********************************!*\
  !*** ./src/lib/firebase-admin.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getFirestoreAdmin: () => (/* binding */ getFirestoreAdmin),\n/* harmony export */   testFirestoreConnection: () => (/* binding */ testFirestoreConnection),\n/* harmony export */   withRetry: () => (/* binding */ withRetry)\n/* harmony export */ });\n/* harmony import */ var firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase-admin/app */ \"firebase-admin/app\");\n/* harmony import */ var firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase-admin/firestore */ \"firebase-admin/firestore\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__, firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__]);\n([firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__, firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n// Initialize Firebase Admin SDK\nfunction initializeFirebaseAdmin() {\n    // Check if Firebase Admin is already initialized\n    if ((0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.getApps)().length > 0) {\n        return (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.getApps)()[0];\n    }\n    // For build-time usage, we'll use service account key\n    // Support both full JSON key and individual environment variables\n    const serviceAccountJson = process.env.FIREBASE_SERVICE_ACCOUNT_KEY;\n    const projectId = process.env.FIREBASE_PROJECT_ID || \"overlandaventure\";\n    const clientEmail = process.env.FIREBASE_CLIENT_EMAIL;\n    const privateKey = process.env.FIREBASE_PRIVATE_KEY;\n    let serviceAccountKey;\n    if (serviceAccountJson) {\n        // Use full JSON service account key\n        try {\n            serviceAccountKey = JSON.parse(serviceAccountJson);\n        } catch (error) {\n            throw new Error(\"Invalid FIREBASE_SERVICE_ACCOUNT_KEY format. Must be valid JSON.\");\n        }\n    } else if (clientEmail && privateKey) {\n        // Use individual environment variables\n        serviceAccountKey = {\n            type: \"service_account\",\n            project_id: projectId,\n            client_email: clientEmail,\n            private_key: privateKey.replace(/\\\\n/g, \"\\n\")\n        };\n    } else {\n        throw new Error(\"Firebase Admin authentication required. Provide either:\\n\" + \"1. FIREBASE_SERVICE_ACCOUNT_KEY (full JSON)\\n\" + \"2. FIREBASE_CLIENT_EMAIL and FIREBASE_PRIVATE_KEY (individual fields)\");\n    }\n    const app = (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.initializeApp)({\n        credential: (0,firebase_admin_app__WEBPACK_IMPORTED_MODULE_0__.cert)(serviceAccountKey),\n        projectId: serviceAccountKey.project_id || \"overlandaventure\"\n    });\n    return app;\n}\n// Get Firestore instance\nfunction getFirestoreAdmin() {\n    const app = initializeFirebaseAdmin();\n    return (0,firebase_admin_firestore__WEBPACK_IMPORTED_MODULE_1__.getFirestore)(app);\n}\n// Connection utility with error handling\nasync function testFirestoreConnection() {\n    try {\n        const db = getFirestoreAdmin();\n        // Test connection by attempting to read from a collection\n        await db.collection(\"country\").limit(1).get();\n        console.log(\"✅ Firestore connection successful\");\n        return true;\n    } catch (error) {\n        console.error(\"❌ Firestore connection failed:\", error);\n        throw error;\n    }\n}\n// Retry utility for Firestore operations\nasync function withRetry(operation, maxRetries = 3, baseDelay = 1000) {\n    let lastError;\n    for(let attempt = 1; attempt <= maxRetries; attempt++){\n        try {\n            return await operation();\n        } catch (error) {\n            lastError = error;\n            if (attempt === maxRetries) {\n                throw lastError;\n            }\n            // Exponential backoff\n            const delay = baseDelay * Math.pow(2, attempt - 1);\n            console.warn(`Attempt ${attempt} failed, retrying in ${delay}ms...`, error);\n            await new Promise((resolve)=>setTimeout(resolve, delay));\n        }\n    }\n    throw lastError;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2ZpcmViYXNlLWFkbWluLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQWlFO0FBQ1Y7QUFFdkQsZ0NBQWdDO0FBQ2hDLFNBQVNJO0lBQ1AsaURBQWlEO0lBQ2pELElBQUlILDJEQUFPQSxHQUFHSSxNQUFNLEdBQUcsR0FBRztRQUN4QixPQUFPSiwyREFBT0EsRUFBRSxDQUFDLEVBQUU7SUFDckI7SUFFQSxzREFBc0Q7SUFDdEQsa0VBQWtFO0lBQ2xFLE1BQU1LLHFCQUFxQkMsUUFBUUMsR0FBRyxDQUFDQyw0QkFBNEI7SUFDbkUsTUFBTUMsWUFBWUgsUUFBUUMsR0FBRyxDQUFDRyxtQkFBbUIsSUFBSTtJQUNyRCxNQUFNQyxjQUFjTCxRQUFRQyxHQUFHLENBQUNLLHFCQUFxQjtJQUNyRCxNQUFNQyxhQUFhUCxRQUFRQyxHQUFHLENBQUNPLG9CQUFvQjtJQUVuRCxJQUFJQztJQUVKLElBQUlWLG9CQUFvQjtRQUN0QixvQ0FBb0M7UUFDcEMsSUFBSTtZQUNGVSxvQkFBb0JDLEtBQUtDLEtBQUssQ0FBQ1o7UUFDakMsRUFBRSxPQUFPYSxPQUFPO1lBQ2QsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO0lBQ0YsT0FBTyxJQUFJUixlQUFlRSxZQUFZO1FBQ3BDLHVDQUF1QztRQUN2Q0Usb0JBQW9CO1lBQ2xCSyxNQUFNO1lBQ05DLFlBQVlaO1lBQ1phLGNBQWNYO1lBQ2RZLGFBQWFWLFdBQVdXLE9BQU8sQ0FBQyxRQUFRO1FBQzFDO0lBQ0YsT0FBTztRQUNMLE1BQU0sSUFBSUwsTUFDUiw4REFDQSxrREFDQTtJQUVKO0lBRUEsTUFBTU0sTUFBTTFCLGlFQUFhQSxDQUFDO1FBQ3hCMkIsWUFBWXpCLHdEQUFJQSxDQUFDYztRQUNqQk4sV0FBV00sa0JBQWtCTSxVQUFVLElBQUk7SUFDN0M7SUFFQSxPQUFPSTtBQUNUO0FBRUEseUJBQXlCO0FBQ2xCLFNBQVNFO0lBQ2QsTUFBTUYsTUFBTXRCO0lBQ1osT0FBT0Qsc0VBQVlBLENBQUN1QjtBQUN0QjtBQUVBLHlDQUF5QztBQUNsQyxlQUFlRztJQUNwQixJQUFJO1FBQ0YsTUFBTUMsS0FBS0Y7UUFDWCwwREFBMEQ7UUFDMUQsTUFBTUUsR0FBR0MsVUFBVSxDQUFDLFdBQVdDLEtBQUssQ0FBQyxHQUFHQyxHQUFHO1FBQzNDQyxRQUFRQyxHQUFHLENBQUM7UUFDWixPQUFPO0lBQ1QsRUFBRSxPQUFPaEIsT0FBTztRQUNkZSxRQUFRZixLQUFLLENBQUMsa0NBQWtDQTtRQUNoRCxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSx5Q0FBeUM7QUFDbEMsZUFBZWlCLFVBQ3BCQyxTQUEyQixFQUMzQkMsYUFBcUIsQ0FBQyxFQUN0QkMsWUFBb0IsSUFBSTtJQUV4QixJQUFJQztJQUVKLElBQUssSUFBSUMsVUFBVSxHQUFHQSxXQUFXSCxZQUFZRyxVQUFXO1FBQ3RELElBQUk7WUFDRixPQUFPLE1BQU1KO1FBQ2YsRUFBRSxPQUFPbEIsT0FBTztZQUNkcUIsWUFBWXJCO1lBRVosSUFBSXNCLFlBQVlILFlBQVk7Z0JBQzFCLE1BQU1FO1lBQ1I7WUFFQSxzQkFBc0I7WUFDdEIsTUFBTUUsUUFBUUgsWUFBWUksS0FBS0MsR0FBRyxDQUFDLEdBQUdILFVBQVU7WUFDaERQLFFBQVFXLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRUosUUFBUSxxQkFBcUIsRUFBRUMsTUFBTSxLQUFLLENBQUMsRUFBRXZCO1lBQ3JFLE1BQU0sSUFBSTJCLFFBQVFDLENBQUFBLFVBQVdDLFdBQVdELFNBQVNMO1FBQ25EO0lBQ0Y7SUFFQSxNQUFNRjtBQUNSIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3ZlcmxhbmRpbmctbWFwcy8uL3NyYy9saWIvZmlyZWJhc2UtYWRtaW4udHM/OGUwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpbml0aWFsaXplQXBwLCBnZXRBcHBzLCBjZXJ0IH0gZnJvbSAnZmlyZWJhc2UtYWRtaW4vYXBwJ1xuaW1wb3J0IHsgZ2V0RmlyZXN0b3JlIH0gZnJvbSAnZmlyZWJhc2UtYWRtaW4vZmlyZXN0b3JlJ1xuXG4vLyBJbml0aWFsaXplIEZpcmViYXNlIEFkbWluIFNES1xuZnVuY3Rpb24gaW5pdGlhbGl6ZUZpcmViYXNlQWRtaW4oKSB7XG4gIC8vIENoZWNrIGlmIEZpcmViYXNlIEFkbWluIGlzIGFscmVhZHkgaW5pdGlhbGl6ZWRcbiAgaWYgKGdldEFwcHMoKS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIGdldEFwcHMoKVswXVxuICB9XG5cbiAgLy8gRm9yIGJ1aWxkLXRpbWUgdXNhZ2UsIHdlJ2xsIHVzZSBzZXJ2aWNlIGFjY291bnQga2V5XG4gIC8vIFN1cHBvcnQgYm90aCBmdWxsIEpTT04ga2V5IGFuZCBpbmRpdmlkdWFsIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICBjb25zdCBzZXJ2aWNlQWNjb3VudEpzb24gPSBwcm9jZXNzLmVudi5GSVJFQkFTRV9TRVJWSUNFX0FDQ09VTlRfS0VZXG4gIGNvbnN0IHByb2plY3RJZCA9IHByb2Nlc3MuZW52LkZJUkVCQVNFX1BST0pFQ1RfSUQgfHwgJ292ZXJsYW5kYXZlbnR1cmUnXG4gIGNvbnN0IGNsaWVudEVtYWlsID0gcHJvY2Vzcy5lbnYuRklSRUJBU0VfQ0xJRU5UX0VNQUlMXG4gIGNvbnN0IHByaXZhdGVLZXkgPSBwcm9jZXNzLmVudi5GSVJFQkFTRV9QUklWQVRFX0tFWVxuXG4gIGxldCBzZXJ2aWNlQWNjb3VudEtleVxuXG4gIGlmIChzZXJ2aWNlQWNjb3VudEpzb24pIHtcbiAgICAvLyBVc2UgZnVsbCBKU09OIHNlcnZpY2UgYWNjb3VudCBrZXlcbiAgICB0cnkge1xuICAgICAgc2VydmljZUFjY291bnRLZXkgPSBKU09OLnBhcnNlKHNlcnZpY2VBY2NvdW50SnNvbilcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIEZJUkVCQVNFX1NFUlZJQ0VfQUNDT1VOVF9LRVkgZm9ybWF0LiBNdXN0IGJlIHZhbGlkIEpTT04uJylcbiAgICB9XG4gIH0gZWxzZSBpZiAoY2xpZW50RW1haWwgJiYgcHJpdmF0ZUtleSkge1xuICAgIC8vIFVzZSBpbmRpdmlkdWFsIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICAgIHNlcnZpY2VBY2NvdW50S2V5ID0ge1xuICAgICAgdHlwZTogJ3NlcnZpY2VfYWNjb3VudCcsXG4gICAgICBwcm9qZWN0X2lkOiBwcm9qZWN0SWQsXG4gICAgICBjbGllbnRfZW1haWw6IGNsaWVudEVtYWlsLFxuICAgICAgcHJpdmF0ZV9rZXk6IHByaXZhdGVLZXkucmVwbGFjZSgvXFxcXG4vZywgJ1xcbicpLCAvLyBIYW5kbGUgZXNjYXBlZCBuZXdsaW5lc1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnRmlyZWJhc2UgQWRtaW4gYXV0aGVudGljYXRpb24gcmVxdWlyZWQuIFByb3ZpZGUgZWl0aGVyOlxcbicgK1xuICAgICAgJzEuIEZJUkVCQVNFX1NFUlZJQ0VfQUNDT1VOVF9LRVkgKGZ1bGwgSlNPTilcXG4nICtcbiAgICAgICcyLiBGSVJFQkFTRV9DTElFTlRfRU1BSUwgYW5kIEZJUkVCQVNFX1BSSVZBVEVfS0VZIChpbmRpdmlkdWFsIGZpZWxkcyknXG4gICAgKVxuICB9XG5cbiAgY29uc3QgYXBwID0gaW5pdGlhbGl6ZUFwcCh7XG4gICAgY3JlZGVudGlhbDogY2VydChzZXJ2aWNlQWNjb3VudEtleSksXG4gICAgcHJvamVjdElkOiBzZXJ2aWNlQWNjb3VudEtleS5wcm9qZWN0X2lkIHx8ICdvdmVybGFuZGF2ZW50dXJlJ1xuICB9KVxuXG4gIHJldHVybiBhcHBcbn1cblxuLy8gR2V0IEZpcmVzdG9yZSBpbnN0YW5jZVxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpcmVzdG9yZUFkbWluKCkge1xuICBjb25zdCBhcHAgPSBpbml0aWFsaXplRmlyZWJhc2VBZG1pbigpXG4gIHJldHVybiBnZXRGaXJlc3RvcmUoYXBwKVxufVxuXG4vLyBDb25uZWN0aW9uIHV0aWxpdHkgd2l0aCBlcnJvciBoYW5kbGluZ1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRlc3RGaXJlc3RvcmVDb25uZWN0aW9uKCkge1xuICB0cnkge1xuICAgIGNvbnN0IGRiID0gZ2V0RmlyZXN0b3JlQWRtaW4oKVxuICAgIC8vIFRlc3QgY29ubmVjdGlvbiBieSBhdHRlbXB0aW5nIHRvIHJlYWQgZnJvbSBhIGNvbGxlY3Rpb25cbiAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKCdjb3VudHJ5JykubGltaXQoMSkuZ2V0KClcbiAgICBjb25zb2xlLmxvZygn4pyFIEZpcmVzdG9yZSBjb25uZWN0aW9uIHN1Y2Nlc3NmdWwnKVxuICAgIHJldHVybiB0cnVlXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEZpcmVzdG9yZSBjb25uZWN0aW9uIGZhaWxlZDonLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8vIFJldHJ5IHV0aWxpdHkgZm9yIEZpcmVzdG9yZSBvcGVyYXRpb25zXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gd2l0aFJldHJ5PFQ+KFxuICBvcGVyYXRpb246ICgpID0+IFByb21pc2U8VD4sXG4gIG1heFJldHJpZXM6IG51bWJlciA9IDMsXG4gIGJhc2VEZWxheTogbnVtYmVyID0gMTAwMFxuKTogUHJvbWlzZTxUPiB7XG4gIGxldCBsYXN0RXJyb3I6IEVycm9yXG5cbiAgZm9yIChsZXQgYXR0ZW1wdCA9IDE7IGF0dGVtcHQgPD0gbWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCBvcGVyYXRpb24oKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsYXN0RXJyb3IgPSBlcnJvciBhcyBFcnJvclxuICAgICAgXG4gICAgICBpZiAoYXR0ZW1wdCA9PT0gbWF4UmV0cmllcykge1xuICAgICAgICB0aHJvdyBsYXN0RXJyb3JcbiAgICAgIH1cblxuICAgICAgLy8gRXhwb25lbnRpYWwgYmFja29mZlxuICAgICAgY29uc3QgZGVsYXkgPSBiYXNlRGVsYXkgKiBNYXRoLnBvdygyLCBhdHRlbXB0IC0gMSlcbiAgICAgIGNvbnNvbGUud2FybihgQXR0ZW1wdCAke2F0dGVtcHR9IGZhaWxlZCwgcmV0cnlpbmcgaW4gJHtkZWxheX1tcy4uLmAsIGVycm9yKVxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSlcbiAgICB9XG4gIH1cblxuICB0aHJvdyBsYXN0RXJyb3IhXG59Il0sIm5hbWVzIjpbImluaXRpYWxpemVBcHAiLCJnZXRBcHBzIiwiY2VydCIsImdldEZpcmVzdG9yZSIsImluaXRpYWxpemVGaXJlYmFzZUFkbWluIiwibGVuZ3RoIiwic2VydmljZUFjY291bnRKc29uIiwicHJvY2VzcyIsImVudiIsIkZJUkVCQVNFX1NFUlZJQ0VfQUNDT1VOVF9LRVkiLCJwcm9qZWN0SWQiLCJGSVJFQkFTRV9QUk9KRUNUX0lEIiwiY2xpZW50RW1haWwiLCJGSVJFQkFTRV9DTElFTlRfRU1BSUwiLCJwcml2YXRlS2V5IiwiRklSRUJBU0VfUFJJVkFURV9LRVkiLCJzZXJ2aWNlQWNjb3VudEtleSIsIkpTT04iLCJwYXJzZSIsImVycm9yIiwiRXJyb3IiLCJ0eXBlIiwicHJvamVjdF9pZCIsImNsaWVudF9lbWFpbCIsInByaXZhdGVfa2V5IiwicmVwbGFjZSIsImFwcCIsImNyZWRlbnRpYWwiLCJnZXRGaXJlc3RvcmVBZG1pbiIsInRlc3RGaXJlc3RvcmVDb25uZWN0aW9uIiwiZGIiLCJjb2xsZWN0aW9uIiwibGltaXQiLCJnZXQiLCJjb25zb2xlIiwibG9nIiwid2l0aFJldHJ5Iiwib3BlcmF0aW9uIiwibWF4UmV0cmllcyIsImJhc2VEZWxheSIsImxhc3RFcnJvciIsImF0dGVtcHQiLCJkZWxheSIsIk1hdGgiLCJwb3ciLCJ3YXJuIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/firebase-admin.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/firestore-data-fetcher.ts":
/*!*******************************************!*\
  !*** ./src/lib/firestore-data-fetcher.ts ***!
  \*******************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FirestoreDataFetcher: () => (/* binding */ FirestoreDataFetcher)\n/* harmony export */ });\n/* harmony import */ var _firebase_admin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./firebase-admin */ \"(rsc)/./src/lib/firebase-admin.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_firebase_admin__WEBPACK_IMPORTED_MODULE_0__]);\n_firebase_admin__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nclass FirestoreDataFetcher {\n    /**\n   * Fetch all documents from the Country Collection\n   * Includes iso_a3 field for linking with map features\n   */ async fetchCountries() {\n        console.log(\"\\uD83D\\uDD04 Fetching countries from Firestore...\");\n        return (0,_firebase_admin__WEBPACK_IMPORTED_MODULE_0__.withRetry)(async ()=>{\n            const snapshot = await this.db.collection(\"country\").get();\n            if (snapshot.empty) {\n                console.warn(\"⚠️ No countries found in Firestore\");\n                return [];\n            }\n            const countries = [];\n            snapshot.forEach((doc)=>{\n                const data = doc.data();\n                const country = {\n                    id: doc.id,\n                    iso_a3: data.iso_a3 || data.iso3 || data.ISO_A3,\n                    name: data.name || data.country_name || \"Unknown\",\n                    parameters: {\n                        ...data\n                    },\n                    borderIds: [],\n                    disputed: data.disputed || undefined // Extract disputed field to top level\n                };\n                countries.push(country);\n            });\n            console.log(`✅ Fetched ${countries.length} countries`);\n            return countries;\n        });\n    }\n    /**\n   * Fetch all documents from the Border Collection\n   * Extracts GeoJSON geometry from geomString field\n   */ async fetchBorders() {\n        console.log(\"\\uD83D\\uDD04 Fetching borders from Firestore...\");\n        return (0,_firebase_admin__WEBPACK_IMPORTED_MODULE_0__.withRetry)(async ()=>{\n            const snapshot = await this.db.collection(\"border\").get();\n            if (snapshot.empty) {\n                console.warn(\"⚠️ No borders found in Firestore\");\n                return [];\n            }\n            const borders = [];\n            snapshot.forEach((doc)=>{\n                const data = doc.data();\n                if (!data.geomString) {\n                    console.warn(`⚠️ Border ${doc.id} missing geomString field`);\n                    return;\n                }\n                const border = {\n                    id: doc.id,\n                    geomString: data.geomString,\n                    properties: {\n                        ...data\n                    } // Include all other fields as properties\n                };\n                borders.push(border);\n            });\n            console.log(`✅ Fetched ${borders.length} borders`);\n            return borders;\n        });\n    }\n    /**\n   * Fetch borders subcollection for a specific country\n   * Returns array of border document IDs referenced by the country\n   */ async fetchCountryBorders(countryId) {\n        return (0,_firebase_admin__WEBPACK_IMPORTED_MODULE_0__.withRetry)(async ()=>{\n            const snapshot = await this.db.collection(\"country\").doc(countryId).collection(\"borders\").get();\n            if (snapshot.empty) {\n                return [];\n            }\n            const borderIds = [];\n            snapshot.forEach((doc)=>{\n                // The document ID in the subcollection should reference a border document\n                borderIds.push(doc.id);\n            });\n            return borderIds;\n        });\n    }\n    /**\n   * Fetch all countries with their associated border IDs\n   * This combines country data with their borders subcollections\n   */ async fetchCountriesWithBorders() {\n        console.log(\"\\uD83D\\uDD04 Fetching countries with border relationships...\");\n        const countries = await this.fetchCountries();\n        // Fetch border relationships for each country\n        const countriesWithBorders = await Promise.all(countries.map(async (country)=>{\n            try {\n                const borderIds = await this.fetchCountryBorders(country.id);\n                return {\n                    ...country,\n                    borderIds\n                };\n            } catch (error) {\n                console.warn(`⚠️ Failed to fetch borders for country ${country.id}:`, error);\n                return country // Return country without border IDs if fetch fails\n                ;\n            }\n        }));\n        console.log(`✅ Fetched ${countriesWithBorders.length} countries with border relationships`);\n        return countriesWithBorders;\n    }\n    /**\n   * Fetch all documents from the Border Post Collection\n   * Extracts Point geometry from location field\n   */ async fetchBorderPosts() {\n        console.log(\"\\uD83D\\uDD04 Fetching border posts from Firestore...\");\n        return (0,_firebase_admin__WEBPACK_IMPORTED_MODULE_0__.withRetry)(async ()=>{\n            const snapshot = await this.db.collection(\"border_post\").get();\n            if (snapshot.empty) {\n                console.warn(\"⚠️ No border posts found in Firestore\");\n                return [];\n            }\n            const borderPosts = [];\n            snapshot.forEach((doc)=>{\n                const data = doc.data();\n                if (!data.location) {\n                    console.warn(`⚠️ Border post ${doc.id} missing location field`);\n                    return;\n                }\n                const borderPost = {\n                    id: doc.id,\n                    location: data.location,\n                    is_open: data.is_open,\n                    properties: {\n                        ...data\n                    } // Include all other fields as properties\n                };\n                borderPosts.push(borderPost);\n            });\n            console.log(`✅ Fetched ${borderPosts.length} border posts`);\n            return borderPosts;\n        });\n    }\n    /**\n   * Validate that required collections exist and have data\n   */ async validateCollections() {\n        console.log(\"\\uD83D\\uDD04 Validating Firestore collections...\");\n        const results = {\n            countries: false,\n            borders: false,\n            borderPosts: false\n        };\n        try {\n            // Check country collection\n            const countrySnapshot = await this.db.collection(\"country\").limit(1).get();\n            results.countries = !countrySnapshot.empty;\n            // Check border collection\n            const borderSnapshot = await this.db.collection(\"border\").limit(1).get();\n            results.borders = !borderSnapshot.empty;\n            // Check border_post collection\n            const borderPostSnapshot = await this.db.collection(\"border_post\").limit(1).get();\n            results.borderPosts = !borderPostSnapshot.empty;\n            console.log(\"\\uD83D\\uDCCA Collection validation results:\", results);\n            if (!results.countries) {\n                console.error(\"❌ Country collection is empty or does not exist\");\n            }\n            if (!results.borders) {\n                console.error(\"❌ Border collection is empty or does not exist\");\n            }\n            if (!results.borderPosts) {\n                console.warn(\"⚠️ Border post collection is empty or does not exist\");\n            }\n            return results;\n        } catch (error) {\n            console.error(\"❌ Collection validation failed:\", error);\n            throw error;\n        }\n    }\n    /**\n   * Get collection statistics for monitoring\n   */ async getCollectionStats() {\n        console.log(\"\\uD83D\\uDCCA Gathering collection statistics...\");\n        const [countries, borders, borderPosts] = await Promise.all([\n            this.fetchCountries(),\n            this.fetchBorders(),\n            this.fetchBorderPosts()\n        ]);\n        // Count countries that have border relationships\n        let countriesWithBorders = 0;\n        for (const country of countries){\n            const borderIds = await this.fetchCountryBorders(country.id);\n            if (borderIds.length > 0) {\n                countriesWithBorders++;\n            }\n        }\n        const stats = {\n            countryCount: countries.length,\n            borderCount: borders.length,\n            borderPostCount: borderPosts.length,\n            countriesWithBorders\n        };\n        console.log(\"\\uD83D\\uDCCA Collection statistics:\", stats);\n        return stats;\n    }\n    /**\n   * Cleanup Firebase connections\n   */ async cleanup() {\n        try {\n            // Note: Firebase Admin SDK doesn't have a direct close method\n            // The process.exit(0) in the build script will handle cleanup\n            console.log(\"\\uD83E\\uDDF9 Cleaning up Firebase connections...\");\n        } catch (error) {\n            console.warn(\"⚠️ Error during cleanup:\", error);\n        }\n    }\n    constructor(){\n        this.db = (0,_firebase_admin__WEBPACK_IMPORTED_MODULE_0__.getFirestoreAdmin)();\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUtQLGtFQUFpQkE7O0FBNlFoQyIsInNvdXJjZXMiOlsid2VicGFjazovL292ZXJsYW5kaW5nLW1hcHMvLi9zcmMvbGliL2ZpcmVzdG9yZS1kYXRhLWZldGNoZXIudHM/Mzk1NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRGaXJlc3RvcmVBZG1pbiwgd2l0aFJldHJ5IH0gZnJvbSAnLi9maXJlYmFzZS1hZG1pbidcbmltcG9ydCB7IENvdW50cnlEYXRhLCBCb3JkZXJEYXRhLCBCb3JkZXJQb3N0RGF0YSB9IGZyb20gJy4uL3R5cGVzJ1xuXG5leHBvcnQgY2xhc3MgRmlyZXN0b3JlRGF0YUZldGNoZXIge1xuICBwcml2YXRlIGRiID0gZ2V0RmlyZXN0b3JlQWRtaW4oKVxuXG4gIC8qKlxuICAgKiBGZXRjaCBhbGwgZG9jdW1lbnRzIGZyb20gdGhlIENvdW50cnkgQ29sbGVjdGlvblxuICAgKiBJbmNsdWRlcyBpc29fYTMgZmllbGQgZm9yIGxpbmtpbmcgd2l0aCBtYXAgZmVhdHVyZXNcbiAgICovXG4gIGFzeW5jIGZldGNoQ291bnRyaWVzKCk6IFByb21pc2U8Q291bnRyeURhdGFbXT4ge1xuICAgIGNvbnNvbGUubG9nKCfwn5SEIEZldGNoaW5nIGNvdW50cmllcyBmcm9tIEZpcmVzdG9yZS4uLicpXG4gICAgXG4gICAgcmV0dXJuIHdpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IHRoaXMuZGIuY29sbGVjdGlvbignY291bnRyeScpLmdldCgpXG4gICAgICBcbiAgICAgIGlmIChzbmFwc2hvdC5lbXB0eSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBObyBjb3VudHJpZXMgZm91bmQgaW4gRmlyZXN0b3JlJylcbiAgICAgICAgcmV0dXJuIFtdXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNvdW50cmllczogQ291bnRyeURhdGFbXSA9IFtdXG4gICAgICBcbiAgICAgIHNuYXBzaG90LmZvckVhY2goKGRvYzogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBkb2MuZGF0YSgpXG4gICAgICAgIFxuICAgICAgICBjb25zdCBjb3VudHJ5OiBDb3VudHJ5RGF0YSA9IHtcbiAgICAgICAgICBpZDogZG9jLmlkLFxuICAgICAgICAgIGlzb19hMzogZGF0YS5pc29fYTMgfHwgZGF0YS5pc28zIHx8IGRhdGEuSVNPX0EzLCAvLyBIYW5kbGUgZGlmZmVyZW50IGZpZWxkIG5hbWUgdmFyaWF0aW9uc1xuICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSB8fCBkYXRhLmNvdW50cnlfbmFtZSB8fCAnVW5rbm93bicsXG4gICAgICAgICAgcGFyYW1ldGVyczogeyAuLi5kYXRhIH0sIC8vIEluY2x1ZGUgYWxsIGZpZWxkcyBhcyBwYXJhbWV0ZXJzXG4gICAgICAgICAgYm9yZGVySWRzOiBbXSwgLy8gV2lsbCBiZSBwb3B1bGF0ZWQgd2hlbiBmZXRjaGluZyBib3JkZXJzIHN1YmNvbGxlY3Rpb25cbiAgICAgICAgICBkaXNwdXRlZDogZGF0YS5kaXNwdXRlZCB8fCB1bmRlZmluZWQgLy8gRXh0cmFjdCBkaXNwdXRlZCBmaWVsZCB0byB0b3AgbGV2ZWxcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY291bnRyaWVzLnB1c2goY291bnRyeSlcbiAgICAgIH0pXG5cbiAgICAgIGNvbnNvbGUubG9nKGDinIUgRmV0Y2hlZCAke2NvdW50cmllcy5sZW5ndGh9IGNvdW50cmllc2ApXG4gICAgICByZXR1cm4gY291bnRyaWVzXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBGZXRjaCBhbGwgZG9jdW1lbnRzIGZyb20gdGhlIEJvcmRlciBDb2xsZWN0aW9uXG4gICAqIEV4dHJhY3RzIEdlb0pTT04gZ2VvbWV0cnkgZnJvbSBnZW9tU3RyaW5nIGZpZWxkXG4gICAqL1xuICBhc3luYyBmZXRjaEJvcmRlcnMoKTogUHJvbWlzZTxCb3JkZXJEYXRhW10+IHtcbiAgICBjb25zb2xlLmxvZygn8J+UhCBGZXRjaGluZyBib3JkZXJzIGZyb20gRmlyZXN0b3JlLi4uJylcbiAgICBcbiAgICByZXR1cm4gd2l0aFJldHJ5KGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgdGhpcy5kYi5jb2xsZWN0aW9uKCdib3JkZXInKS5nZXQoKVxuICAgICAgXG4gICAgICBpZiAoc25hcHNob3QuZW1wdHkpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCfimqDvuI8gTm8gYm9yZGVycyBmb3VuZCBpbiBGaXJlc3RvcmUnKVxuICAgICAgICByZXR1cm4gW11cbiAgICAgIH1cblxuICAgICAgY29uc3QgYm9yZGVyczogQm9yZGVyRGF0YVtdID0gW11cbiAgICAgIFxuICAgICAgc25hcHNob3QuZm9yRWFjaCgoZG9jOiBhbnkpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGRvYy5kYXRhKClcbiAgICAgICAgXG4gICAgICAgIGlmICghZGF0YS5nZW9tU3RyaW5nKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGDimqDvuI8gQm9yZGVyICR7ZG9jLmlkfSBtaXNzaW5nIGdlb21TdHJpbmcgZmllbGRgKVxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYm9yZGVyOiBCb3JkZXJEYXRhID0ge1xuICAgICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgICAgZ2VvbVN0cmluZzogZGF0YS5nZW9tU3RyaW5nLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHsgLi4uZGF0YSB9IC8vIEluY2x1ZGUgYWxsIG90aGVyIGZpZWxkcyBhcyBwcm9wZXJ0aWVzXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGJvcmRlcnMucHVzaChib3JkZXIpXG4gICAgICB9KVxuXG4gICAgICBjb25zb2xlLmxvZyhg4pyFIEZldGNoZWQgJHtib3JkZXJzLmxlbmd0aH0gYm9yZGVyc2ApXG4gICAgICByZXR1cm4gYm9yZGVyc1xuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogRmV0Y2ggYm9yZGVycyBzdWJjb2xsZWN0aW9uIGZvciBhIHNwZWNpZmljIGNvdW50cnlcbiAgICogUmV0dXJucyBhcnJheSBvZiBib3JkZXIgZG9jdW1lbnQgSURzIHJlZmVyZW5jZWQgYnkgdGhlIGNvdW50cnlcbiAgICovXG4gIGFzeW5jIGZldGNoQ291bnRyeUJvcmRlcnMoY291bnRyeUlkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgcmV0dXJuIHdpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IHRoaXMuZGJcbiAgICAgICAgLmNvbGxlY3Rpb24oJ2NvdW50cnknKVxuICAgICAgICAuZG9jKGNvdW50cnlJZClcbiAgICAgICAgLmNvbGxlY3Rpb24oJ2JvcmRlcnMnKVxuICAgICAgICAuZ2V0KClcbiAgICAgIFxuICAgICAgaWYgKHNuYXBzaG90LmVtcHR5KSB7XG4gICAgICAgIHJldHVybiBbXVxuICAgICAgfVxuXG4gICAgICBjb25zdCBib3JkZXJJZHM6IHN0cmluZ1tdID0gW11cbiAgICAgIFxuICAgICAgc25hcHNob3QuZm9yRWFjaCgoZG9jOiBhbnkpID0+IHtcbiAgICAgICAgLy8gVGhlIGRvY3VtZW50IElEIGluIHRoZSBzdWJjb2xsZWN0aW9uIHNob3VsZCByZWZlcmVuY2UgYSBib3JkZXIgZG9jdW1lbnRcbiAgICAgICAgYm9yZGVySWRzLnB1c2goZG9jLmlkKVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIGJvcmRlcklkc1xuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogRmV0Y2ggYWxsIGNvdW50cmllcyB3aXRoIHRoZWlyIGFzc29jaWF0ZWQgYm9yZGVyIElEc1xuICAgKiBUaGlzIGNvbWJpbmVzIGNvdW50cnkgZGF0YSB3aXRoIHRoZWlyIGJvcmRlcnMgc3ViY29sbGVjdGlvbnNcbiAgICovXG4gIGFzeW5jIGZldGNoQ291bnRyaWVzV2l0aEJvcmRlcnMoKTogUHJvbWlzZTxDb3VudHJ5RGF0YVtdPiB7XG4gICAgY29uc29sZS5sb2coJ/CflIQgRmV0Y2hpbmcgY291bnRyaWVzIHdpdGggYm9yZGVyIHJlbGF0aW9uc2hpcHMuLi4nKVxuICAgIFxuICAgIGNvbnN0IGNvdW50cmllcyA9IGF3YWl0IHRoaXMuZmV0Y2hDb3VudHJpZXMoKVxuICAgIFxuICAgIC8vIEZldGNoIGJvcmRlciByZWxhdGlvbnNoaXBzIGZvciBlYWNoIGNvdW50cnlcbiAgICBjb25zdCBjb3VudHJpZXNXaXRoQm9yZGVycyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgY291bnRyaWVzLm1hcChhc3luYyAoY291bnRyeSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGJvcmRlcklkcyA9IGF3YWl0IHRoaXMuZmV0Y2hDb3VudHJ5Qm9yZGVycyhjb3VudHJ5LmlkKVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5jb3VudHJ5LFxuICAgICAgICAgICAgYm9yZGVySWRzXG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIEZhaWxlZCB0byBmZXRjaCBib3JkZXJzIGZvciBjb3VudHJ5ICR7Y291bnRyeS5pZH06YCwgZXJyb3IpXG4gICAgICAgICAgcmV0dXJuIGNvdW50cnkgLy8gUmV0dXJuIGNvdW50cnkgd2l0aG91dCBib3JkZXIgSURzIGlmIGZldGNoIGZhaWxzXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgKVxuXG4gICAgY29uc29sZS5sb2coYOKchSBGZXRjaGVkICR7Y291bnRyaWVzV2l0aEJvcmRlcnMubGVuZ3RofSBjb3VudHJpZXMgd2l0aCBib3JkZXIgcmVsYXRpb25zaGlwc2ApXG4gICAgcmV0dXJuIGNvdW50cmllc1dpdGhCb3JkZXJzXG4gIH1cblxuICAvKipcbiAgICogRmV0Y2ggYWxsIGRvY3VtZW50cyBmcm9tIHRoZSBCb3JkZXIgUG9zdCBDb2xsZWN0aW9uXG4gICAqIEV4dHJhY3RzIFBvaW50IGdlb21ldHJ5IGZyb20gbG9jYXRpb24gZmllbGRcbiAgICovXG4gIGFzeW5jIGZldGNoQm9yZGVyUG9zdHMoKTogUHJvbWlzZTxCb3JkZXJQb3N0RGF0YVtdPiB7XG4gICAgY29uc29sZS5sb2coJ/CflIQgRmV0Y2hpbmcgYm9yZGVyIHBvc3RzIGZyb20gRmlyZXN0b3JlLi4uJylcbiAgICBcbiAgICByZXR1cm4gd2l0aFJldHJ5KGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgdGhpcy5kYi5jb2xsZWN0aW9uKCdib3JkZXJfcG9zdCcpLmdldCgpXG4gICAgICBcbiAgICAgIGlmIChzbmFwc2hvdC5lbXB0eSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBObyBib3JkZXIgcG9zdHMgZm91bmQgaW4gRmlyZXN0b3JlJylcbiAgICAgICAgcmV0dXJuIFtdXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGJvcmRlclBvc3RzOiBCb3JkZXJQb3N0RGF0YVtdID0gW11cbiAgICAgIFxuICAgICAgc25hcHNob3QuZm9yRWFjaCgoZG9jOiBhbnkpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGRvYy5kYXRhKClcbiAgICAgICAgXG4gICAgICAgIGlmICghZGF0YS5sb2NhdGlvbikge1xuICAgICAgICAgIGNvbnNvbGUud2Fybihg4pqg77iPIEJvcmRlciBwb3N0ICR7ZG9jLmlkfSBtaXNzaW5nIGxvY2F0aW9uIGZpZWxkYClcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJvcmRlclBvc3Q6IEJvcmRlclBvc3REYXRhID0ge1xuICAgICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgICAgbG9jYXRpb246IGRhdGEubG9jYXRpb24sXG4gICAgICAgICAgaXNfb3BlbjogZGF0YS5pc19vcGVuLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHsgLi4uZGF0YSB9IC8vIEluY2x1ZGUgYWxsIG90aGVyIGZpZWxkcyBhcyBwcm9wZXJ0aWVzXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGJvcmRlclBvc3RzLnB1c2goYm9yZGVyUG9zdClcbiAgICAgIH0pXG5cbiAgICAgIGNvbnNvbGUubG9nKGDinIUgRmV0Y2hlZCAke2JvcmRlclBvc3RzLmxlbmd0aH0gYm9yZGVyIHBvc3RzYClcbiAgICAgIHJldHVybiBib3JkZXJQb3N0c1xuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgdGhhdCByZXF1aXJlZCBjb2xsZWN0aW9ucyBleGlzdCBhbmQgaGF2ZSBkYXRhXG4gICAqL1xuICBhc3luYyB2YWxpZGF0ZUNvbGxlY3Rpb25zKCk6IFByb21pc2U8eyBjb3VudHJpZXM6IGJvb2xlYW47IGJvcmRlcnM6IGJvb2xlYW47IGJvcmRlclBvc3RzOiBib29sZWFuIH0+IHtcbiAgICBjb25zb2xlLmxvZygn8J+UhCBWYWxpZGF0aW5nIEZpcmVzdG9yZSBjb2xsZWN0aW9ucy4uLicpXG4gICAgXG4gICAgY29uc3QgcmVzdWx0cyA9IHtcbiAgICAgIGNvdW50cmllczogZmFsc2UsXG4gICAgICBib3JkZXJzOiBmYWxzZSxcbiAgICAgIGJvcmRlclBvc3RzOiBmYWxzZVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBDaGVjayBjb3VudHJ5IGNvbGxlY3Rpb25cbiAgICAgIGNvbnN0IGNvdW50cnlTbmFwc2hvdCA9IGF3YWl0IHRoaXMuZGIuY29sbGVjdGlvbignY291bnRyeScpLmxpbWl0KDEpLmdldCgpXG4gICAgICByZXN1bHRzLmNvdW50cmllcyA9ICFjb3VudHJ5U25hcHNob3QuZW1wdHlcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgYm9yZGVyIGNvbGxlY3Rpb25cbiAgICAgIGNvbnN0IGJvcmRlclNuYXBzaG90ID0gYXdhaXQgdGhpcy5kYi5jb2xsZWN0aW9uKCdib3JkZXInKS5saW1pdCgxKS5nZXQoKVxuICAgICAgcmVzdWx0cy5ib3JkZXJzID0gIWJvcmRlclNuYXBzaG90LmVtcHR5XG4gICAgICBcbiAgICAgIC8vIENoZWNrIGJvcmRlcl9wb3N0IGNvbGxlY3Rpb25cbiAgICAgIGNvbnN0IGJvcmRlclBvc3RTbmFwc2hvdCA9IGF3YWl0IHRoaXMuZGIuY29sbGVjdGlvbignYm9yZGVyX3Bvc3QnKS5saW1pdCgxKS5nZXQoKVxuICAgICAgcmVzdWx0cy5ib3JkZXJQb3N0cyA9ICFib3JkZXJQb3N0U25hcHNob3QuZW1wdHlcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ/Cfk4ogQ29sbGVjdGlvbiB2YWxpZGF0aW9uIHJlc3VsdHM6JywgcmVzdWx0cylcbiAgICAgIFxuICAgICAgaWYgKCFyZXN1bHRzLmNvdW50cmllcykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgQ291bnRyeSBjb2xsZWN0aW9uIGlzIGVtcHR5IG9yIGRvZXMgbm90IGV4aXN0JylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKCFyZXN1bHRzLmJvcmRlcnMpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEJvcmRlciBjb2xsZWN0aW9uIGlzIGVtcHR5IG9yIGRvZXMgbm90IGV4aXN0JylcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKCFyZXN1bHRzLmJvcmRlclBvc3RzKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIEJvcmRlciBwb3N0IGNvbGxlY3Rpb24gaXMgZW1wdHkgb3IgZG9lcyBub3QgZXhpc3QnKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gcmVzdWx0c1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgQ29sbGVjdGlvbiB2YWxpZGF0aW9uIGZhaWxlZDonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb2xsZWN0aW9uIHN0YXRpc3RpY3MgZm9yIG1vbml0b3JpbmdcbiAgICovXG4gIGFzeW5jIGdldENvbGxlY3Rpb25TdGF0cygpOiBQcm9taXNlPHtcbiAgICBjb3VudHJ5Q291bnQ6IG51bWJlclxuICAgIGJvcmRlckNvdW50OiBudW1iZXJcbiAgICBib3JkZXJQb3N0Q291bnQ6IG51bWJlclxuICAgIGNvdW50cmllc1dpdGhCb3JkZXJzOiBudW1iZXJcbiAgfT4ge1xuICAgIGNvbnNvbGUubG9nKCfwn5OKIEdhdGhlcmluZyBjb2xsZWN0aW9uIHN0YXRpc3RpY3MuLi4nKVxuICAgIFxuICAgIGNvbnN0IFtjb3VudHJpZXMsIGJvcmRlcnMsIGJvcmRlclBvc3RzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIHRoaXMuZmV0Y2hDb3VudHJpZXMoKSxcbiAgICAgIHRoaXMuZmV0Y2hCb3JkZXJzKCksXG4gICAgICB0aGlzLmZldGNoQm9yZGVyUG9zdHMoKVxuICAgIF0pXG5cbiAgICAvLyBDb3VudCBjb3VudHJpZXMgdGhhdCBoYXZlIGJvcmRlciByZWxhdGlvbnNoaXBzXG4gICAgbGV0IGNvdW50cmllc1dpdGhCb3JkZXJzID0gMFxuICAgIGZvciAoY29uc3QgY291bnRyeSBvZiBjb3VudHJpZXMpIHtcbiAgICAgIGNvbnN0IGJvcmRlcklkcyA9IGF3YWl0IHRoaXMuZmV0Y2hDb3VudHJ5Qm9yZGVycyhjb3VudHJ5LmlkKVxuICAgICAgaWYgKGJvcmRlcklkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvdW50cmllc1dpdGhCb3JkZXJzKytcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzdGF0cyA9IHtcbiAgICAgIGNvdW50cnlDb3VudDogY291bnRyaWVzLmxlbmd0aCxcbiAgICAgIGJvcmRlckNvdW50OiBib3JkZXJzLmxlbmd0aCxcbiAgICAgIGJvcmRlclBvc3RDb3VudDogYm9yZGVyUG9zdHMubGVuZ3RoLFxuICAgICAgY291bnRyaWVzV2l0aEJvcmRlcnNcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygn8J+TiiBDb2xsZWN0aW9uIHN0YXRpc3RpY3M6Jywgc3RhdHMpXG4gICAgcmV0dXJuIHN0YXRzXG4gIH1cblxuICAvKipcbiAgICogQ2xlYW51cCBGaXJlYmFzZSBjb25uZWN0aW9uc1xuICAgKi9cbiAgYXN5bmMgY2xlYW51cCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gTm90ZTogRmlyZWJhc2UgQWRtaW4gU0RLIGRvZXNuJ3QgaGF2ZSBhIGRpcmVjdCBjbG9zZSBtZXRob2RcbiAgICAgIC8vIFRoZSBwcm9jZXNzLmV4aXQoMCkgaW4gdGhlIGJ1aWxkIHNjcmlwdCB3aWxsIGhhbmRsZSBjbGVhbnVwXG4gICAgICBjb25zb2xlLmxvZygn8J+nuSBDbGVhbmluZyB1cCBGaXJlYmFzZSBjb25uZWN0aW9ucy4uLicpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIEVycm9yIGR1cmluZyBjbGVhbnVwOicsIGVycm9yKVxuICAgIH1cbiAgfVxufSJdLCJuYW1lcyI6WyJnZXRGaXJlc3RvcmVBZG1pbiIsIndpdGhSZXRyeSIsIkZpcmVzdG9yZURhdGFGZXRjaGVyIiwiZmV0Y2hDb3VudHJpZXMiLCJjb25zb2xlIiwibG9nIiwic25hcHNob3QiLCJkYiIsImNvbGxlY3Rpb24iLCJnZXQiLCJlbXB0eSIsIndhcm4iLCJjb3VudHJpZXMiLCJmb3JFYWNoIiwiZG9jIiwiZGF0YSIsImNvdW50cnkiLCJpZCIsImlzb19hMyIsImlzbzMiLCJJU09fQTMiLCJuYW1lIiwiY291bnRyeV9uYW1lIiwicGFyYW1ldGVycyIsImJvcmRlcklkcyIsImRpc3B1dGVkIiwidW5kZWZpbmVkIiwicHVzaCIsImxlbmd0aCIsImZldGNoQm9yZGVycyIsImJvcmRlcnMiLCJnZW9tU3RyaW5nIiwiYm9yZGVyIiwicHJvcGVydGllcyIsImZldGNoQ291bnRyeUJvcmRlcnMiLCJjb3VudHJ5SWQiLCJmZXRjaENvdW50cmllc1dpdGhCb3JkZXJzIiwiY291bnRyaWVzV2l0aEJvcmRlcnMiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwiZXJyb3IiLCJmZXRjaEJvcmRlclBvc3RzIiwiYm9yZGVyUG9zdHMiLCJsb2NhdGlvbiIsImJvcmRlclBvc3QiLCJpc19vcGVuIiwidmFsaWRhdGVDb2xsZWN0aW9ucyIsInJlc3VsdHMiLCJjb3VudHJ5U25hcHNob3QiLCJsaW1pdCIsImJvcmRlclNuYXBzaG90IiwiYm9yZGVyUG9zdFNuYXBzaG90IiwiZ2V0Q29sbGVjdGlvblN0YXRzIiwic3RhdHMiLCJjb3VudHJ5Q291bnQiLCJib3JkZXJDb3VudCIsImJvcmRlclBvc3RDb3VudCIsImNsZWFudXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/firestore-data-fetcher.ts\n");

/***/ })

};
;